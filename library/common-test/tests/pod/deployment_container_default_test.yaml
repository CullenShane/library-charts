suite: deployment container default test
templates:
  - common.yaml
tests:
  - it: should pass with default values
    asserts:
      - documentIndex: &deploymentDoc 0
        isKind:
          of: Deployment
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.hostNetwork
          value: false
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.terminationGracePeriodSeconds
          value: 10
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.enableServiceLinks
          value: false
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.terminationGracePeriodSeconds
          value: 10
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.hostname
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.priorityClassName
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.schedulerName
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].name
          value: RELEASE-NAME-common-test
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].image
          value: repo:tag
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].command
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].args
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].tty
          value: false
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].stdin
          value: false
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].lifecycle
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].terminationMessagePath
      - isNull:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].terminationMessagePolicy
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].securityContext
          value:
            allowPrivilegeEscalation: false
            capabilities:
              add: []
              drop: []
            privileged: false
            readOnlyRootFilesystem: true
            runAsNonRoot: true
      - equal:
          documentIndex: *deploymentDoc
          path: spec.template.spec.containers[0].env
          value:
            - name: TZ
              value: UTC
            - name: UMASK
              value: "2"
            - name: UMASK_SET
              value: "2"
            - name: NVIDIA_VISIBLE_DEVICES
              value: void
            - name: S6_READ_ONLY_ROOT
              value: "1"
